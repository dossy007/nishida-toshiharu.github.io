<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://cdn.jsdelivr.net/npm/vue" defer></script>
    <script src="https://cdn.jsdelivr.net/npm/vue-scrollto"></script>
    <script src="https://cdn.jsdelivr.net/npm/vue@2.5.16/dist/vue.js"></script>
    <script src="vue-scroll.js" defer></script>
</head>
<body>
    <!-- <div class="code-frame" data-lang="text">
        <pre>
        </pre>
    </div> -->
    
    <div id="app">
    
        <p><a href="contents/sample1.xlsx" download="sample1.xlsx">sample1.xlsxファイルをダウンロード</a></p>
        
        <a href="https://docs.python.org/ja/3/tutorial/">python公式</a>
        
        全体の目次：<br>
        excelの振り分けを初回 sample1.xlsx<br>
        pythonの基礎 文法 構文<br>
        sampledata1.xlsxを使った、データの取得 変換
        test<br>
        フローチャート<br>
        gcの扱い<br>
        <h4>各section</h4>
        <a class="btn-primary" @click="scrollToAnchorPoint('second')">
            変数 型
        </a><br>
        <a class="btn-primary" @click="scrollToAnchorPoint('third')">
            演算子 比較演算子 Bool演算子
        </a><br>
        <a class="btn-primary" @click="scrollToAnchorPoint('forth')">
            if文 list dict
        </a><br>
        <a class="btn-primary" @click="scrollToAnchorPoint('fifth')">
            for文
        </a><br>

        <br>
        <br>

        <div class="content" ref="first">
            {{first}}
           <a href="https://interface.cqpub.co.jp/ail01/">colaboratory 使い方など</a>
            <div class="code-frame" data-lang="text">
                <pre>
                    from google.colab import drive
                    drive.mount('/content/drive')
                    !pip install openpyxl
                    import openpyxl
                    import pandas as pd
                    import glob

                    import_file_path = '/content/drive/My Drive/Colab Notebooks/sample1.xlsx'
                    excel_sheet_name = 'Sheet1'
                    export_file_path = '/content/drive/My Drive/Colab Notebooks/output'
                    df_order = pd.read_excel(import_file_path, sheet_name = excel_sheet_name)
                    df_order

                    management_name = df_order['顧客'].unique()
                    management_name
                    df_order['担当'] == '鈴木'
                    df_order[df_order['担当'] == '佐藤']

                    for i in management_name:
                        df_order_management = df_order[df_order['顧客'] == i]
                        df_order_management.to_excel(export_file_path+'/'+i+'.xlsx')
                    
                    export_file_path = '/content/drive/My Drive/Colab Notebooks/output2'
                    import_file_path = '/content/drive/My Drive/Colab Notebooks/output'
                    path = import_file_path + '/'+'*.xlsx'
                    path

                    file_path = glob.glob(path)
                    file_path

                    df_concat=pd.DataFrame()

                    for i in file_path:
                        df_read_excel = pd.read_excel(i)

                    for i in file_path:
                        df_read_excel = pd.read_excel(i)
                        df_concat = pd.concat([df_read_excel,df_concat])

                    df_concat
                    df_drop = df_concat.drop('Unnamed: 0', axis = 1)
                    df_drop

                    df_sort = df_drop.sort_values(by='案件',ascending=True)
                    df_sort

                    df_sort.to_excel(export_file_path + '/' + '管理シート.xlsx')

                    workbook = openpyxl.load_workbook(export_file_path + '/' + '管理シート.xlsx')
                    worksheet = workbook.worksheets[0]
                    worksheet.delete_cols(1)
                    workbook.save(export_file_path + '/' + '管理シート.xlsx')
                </pre>
            </div>
        </div>
        

        <div class="content" ref="second">
            {{second}}
            <div class="code-frame" data-lang="text">
                <pre>
                    x = 1
                    y = 2    #「変数名 = 変数に入れる値」で変数が定義できる。
                    
                    
                    name = 'yamada'  文字列型、str
                    id = 2           整数型、int
                    point = 1.3      浮動小数点型、float

                    #変数名は、理解可能なものを使い、値には変数名に応じたデータを入れること。
                    NG例)
                    name = '2021/04/14'
                    date = '山田太郎'
                </pre>
            </div>
            型の変換 型の連結
            <div class="code-frame" data-lang="text">
                同じ型同士でなければ、足し算(連結)ができない
                <pre>
                    str()  #strに変換
                    int()  #intに変換

                    #型の連結
                    name + str(id)
                </pre>
                    &lt;span class="box"&gt;箱の中身&lt;/span&gt;
                    HTMLの属性値(class名など)を「"(ダブルクォート)」で囲むことを推奨している。
                    htmlとのやりとりの上で、混在してしまう可能性があるから
                    pythonでは、混同しない様に''で書くことを推奨します。
                    <br>
                    <br>
                    "&lt;span class="box"&gt;箱の中身&lt;/span&gt;"
                    を行うとエラーになったりするので。<br>

                関数：
                何かを入れると何かが出てくる 仕組み
                #変数の中身をみたい場合には、print()を
                #変数の型を確認したい場合には、type()を
                もう一つ、
                pd.read_excel() の様なパターンも存在する。
                pandas classの関数を使う場合に使用する。

                pandasという機能全体の中にある、一機能read_excel()を使う際にこういった書き方をする。
            </div>
        </div>
        
        <div class="content" ref="third">
            {{third}}
            <div class="code-frame" data-lang="text">
                <pre>
                    + - * /    (足す、引く、かける、割る)
                    % ** //    (余り、冪乗(べきじょう)、切り捨て除算)
                </pre>
            </div>
            切り捨て除算は
                10 ÷ 3 = 3 .3333333333333335の時 3になる(余りを除く)
            </br>

            <!--質問力 https://tokyofreelance.jp/question/ -->
            Bool演算子
            <div class="code-frame" data-lang="text">
                <pre>True False</pre>
                <pre>
                    # bool演算子
    # and or not
    # and 2つの条件がどちらも真の時 Trueを返す
    # or 2つの条件がどちらかが真の時 Trueを返す

    # not notは条件式がTrueの場合に、式全体がFalseになります
    1 == 1 or 2 == 2                 #2/2 1/2 0/2


    # 真 True
    # 1==1 and 2==2
    # 1 ==1 or 2==1


    # not 1==2
    # 反対の式
    # 偶数 奇数
                </pre>
            </div>
            比較演算子
            http://www.tohoho-web.com/python/operators.html
                <div class="code-frame" data-lang="text">
                    <pre>
                          < > <= >= == 
                        1 < 2  #2未満
                        1 > 2  #2超過
                        1 <= 2 #2以下
                        1 >= 2 #2以上
                        1 == 2 #2と等しい
                    </pre>
                </div>
        </div>
        <div class="content" ref="forth">
             {{forth}}
            <div class="code-frame" data-lang="text">
                <pre>
                    number = 2
                    if number == 1:
                        print('1です')
                    elif number == 2:
                        print('2です')
                    else:
                        print('それ以外です')

                    lists = [101,102,103,104,105]
                        => lists[0]
                    dict = {'key':'value','id':11,'name':'yamada'}
                        =>dict['name']
                </pre>
            </div>
        </div>
        <div class="content" ref="fifth">
             {{fifth}}
            <div class="code-frame" data-lang="text">
                配列などは、複数の情報をもつ
                一つずつ取り出してやらないといけない
                <pre>
                    # 書き方
                    for 変数名 in イテラブルオブジェクト:
                        処理

                    for i in range(10):
                        print(i)

                    #範囲指定
                    for i in range(1,10):
                        #print(i)
                </pre>
                <pre>
                    list = ['Alice', 'Bob', 'Charlie']
                    for name in list:
                        print(name)
                </pre>
                <pre>
                    name_list = ['yamada','sato','kato','nakano','kogane','iwao','gotou','matsumoto']
                    # さんをつけて出力
                    for i in name_list:
                        print(i+'さん')
                </pre>
                <pre>
                    data_list = {'Google':[{'youtube':'ユーチューブ','chromebook':'クロームブック','android':'アンドロイド'}],'Apple':[{'macbook':'マックブック','applewatch':'アップルウォッチ'}],'Amazon':[{'Amazon':'アマゾン','AWS':'アマゾンウェブサービス'}],'Netflix':[],'Microsoft':[]}
                    # これはlistとdictの混合形 これからこんな形のものがしょっちゅう出てくる
                    # data_list['Google'] dict
                    # data_list['Google'][0] list
                    # data_list['Google'][0]['youtube'] dict

                    ちなみにlistだけではなく、dictもforで回すことが可能
                    その際は、keyが取得できる
                    例)
                    for i in data_list:
                        print(i)
                        => Google Apple Amazon Netflix Microsoft
                </pre>
                listについてもう少し
                list.append
                list.remove(x)
                リスト中で x と等しい値を持つ最初の要素を削除します。該当する要素がなければ ValueError が送出されます。
            </div>

            ライブラリとは、機能群 のこと
            google driveにアクセスする機能
            excelシートの情報を取得してくれる機能

            それを借りるのがライブラリ
        </div>

        <div class="content" ref="sixth">
            <div class="code-frame" data-lang="text">
                is is not !=のお話し
            <pre>
                num  = 1
                num1 = 1
                name = 'yamada'
                name1 = 'yamada'
                num_list = [100,101,102]
                num_list1 = [100,101,102]
                ---------------------
                
                num != num1  # ==の逆

                num == num1   =>True
                num is num1   =>True
                name == name1 =>True
                name is name1 =>True
                num_list == num_list1
                num_list is num_list1 =>False

                #intやstrのような単体で使うものであれば関係はないが、
                #listやdictのようなオブジェクト(データの塊)を比べる際にはこのような挙動になる
            </pre>
            </div>  
        </div>

        <div class="content" ref="part2_first">
            {{part2_first}}
            <div class="code-frame" data-lang="text">
                
                <pre>
                    from google.colab import drive
                    drive.mount('/content/drive/')
                    import openpyxl
                    import pandas as pd
                    import glob
                    import re
                    import_file_path = '/content/drive/MyDrive/Colab Notebooks/sampledata1.xlsx'
                    data_sheet_list = 'list'
                    data_sheet_name = 'name'
                    category_sheet_name = 'category'
                    data_employee = pd.read_excel(import_file_path, 0)

                    data_employee
                </pre>
                
        </div>
        <br>
        ここからは、dataの使い方について、学ぶ+ フローチャートについて学ぶ
        2部では .unique()などのexcelに関する関数を用いてデータを取得操作していきます。
        その際に、関数を使って例を見せてその応用問題を宿題で出していく予定。
        途中でフローチャートの考え方を説明、fizzbuzzを用いて説明する予定。
        できたら、何か例を出してフローを考えてもらう。
        フローが終わり次第、2部の後半 2/15以降のpydriveなどを使った過程が違うけれども、結果は同じようなコードを見てもらう。

        3部では、実践編ということでゴリゴリ書いてもらう

        また、listやif,forなどをふんだんに使っていく予定なので
        不安な方は、こちらの演習問題で問題なれすることで理解度が深まるかもしれません。(fizz buzzなど)
        <!-- <div class="content" ref="part2_second">
            <div class="code-frame" data-lang="text">
                <pre>

                </pre>
            </div>
        </div> -->
        <br>
        <br>
        <a href="/second.html">2へいこう</a>
    </div> <!-- app-->
</body>
</html>
